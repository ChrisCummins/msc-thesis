#!/usr/bin/env python2.7

from sys import argv
from re import sub
import benchlib as lib

n=30
experiment = {
    'CannyEdgeDetection': [
        ['', '--map-overlap'],
        ['--radius {0}'.format(x) for x in range(1, 10 + 1, 3)],
        ['--input {0} --output {1}'.format(x, sub('\.pgm', '.out.pgm', x))
         for x in lib.IMAGES]
    ],
    'GameOfLife': [
        ['', '--map-overlap'],
        ['--size {0}'.format(x) for x in range(1024, 4096 + 1, 1024)],
        ['--iterations {0}'.format(x) for x in range(10, 50 + 1, 10)]
    ],
    'FDTD': [
        ['--size {0}'.format(x) for x in range(1024, 4096 + 1, 1024)],
        ['--resolution {0}'.format(x) for x in range(50, 150 + 1, 50)],
    ]
}

if lib.ID() != "cec":
    for prog in experiment:
        experiment[prog].append(['--device_type {0}'.format(x) for x in ['CPU', 'GPU']])

for prog in experiment:
    for options in lib.permutations(prog, experiment[prog]):
        print(prog, options)
        
for i in range(10, 30 + 1, 10):
    for prog in experiment:   
        options = experiment[prog]
        lib.iterate(prog, options=options, n=n, version="e1")
